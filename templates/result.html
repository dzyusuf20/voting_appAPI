<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hasil Voting</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">

<div class="container py-5">
  <h2 class="text-center mb-4">Hasil Voting</h2>
  <canvas id="voteChart"></canvas>
</div>

<script>
const API_URL = "http://127.0.0.1:8000/api/candidates/";

async function loadResults() {
  let response = await fetch(API_URL);
  let candidates = await response.json();

  let labels = candidates.map(c => c.name);
  let votes = candidates.map(c => c.vote_count);

  new Chart(document.getElementById("voteChart"), {
    type: "bar",
    data: {
      labels: labels,
      datasets: [{
        label: "Jumlah Suara",
        data: votes
      }]
    }
  });
}

// Refresh tiap 3 detik biar real-time
setInterval(loadResults, 3000);
loadResults();
</script>

</body>
</html>
